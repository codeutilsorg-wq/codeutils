const Theme={STORAGE_KEY:"codeutils-theme",DARK_CLASS:"dark-mode",init(){"dark"===localStorage.getItem(this.STORAGE_KEY)&&document.body.classList.add(this.DARK_CLASS)},toggle(){document.body.classList.toggle(this.DARK_CLASS);const e=document.body.classList.contains(this.DARK_CLASS);return localStorage.setItem(this.STORAGE_KEY,e?"dark":"light"),e},isDark(){return document.body.classList.contains(this.DARK_CLASS)}},Message={container:null,timeout:null,init(e="message"){this.container=document.getElementById(e)},show(e,t="info",s=5e3){this.container&&(this.container.textContent=e,this.container.className="message "+t,setTimeout(()=>{this.container.scrollIntoView({behavior:"smooth",block:"nearest"})},100),this.timeout&&clearTimeout(this.timeout),s>0&&(this.timeout=setTimeout(()=>{this.hide()},s)))},success(e,t){this.show(e,"success",t)},error(e,t){this.show(e,"error",t)},warning(e,t){this.show(e,"warning",t)},info(e,t){this.show(e,"info",t)},hide(){this.container&&(this.container.className="message")}},Clipboard={async copy(e){if(!e)throw new Error("Nothing to copy");try{if(navigator.clipboard&&navigator.clipboard.writeText)return await navigator.clipboard.writeText(e),!0;const t=document.createElement("textarea");return t.value=e,t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),!0}catch(e){throw new Error("Failed to copy to clipboard")}},async copyFromElement(e){const t=document.getElementById(e);if(!t)throw new Error("Element not found");return this.copy(t.value||t.textContent)}},FileHandler={readAsText:e=>new Promise((t,s)=>{const r=new FileReader;r.onload=e=>t(e.target.result),r.onerror=()=>s(new Error("Failed to read file")),r.readAsText(e)}),readAsDataURL:e=>new Promise((t,s)=>{const r=new FileReader;r.onload=e=>t(e.target.result),r.onerror=()=>s(new Error("Failed to read file")),r.readAsDataURL(e)}),download(e,t,s="text/plain"){const r=new Blob([e],{type:s}),o=URL.createObjectURL(r),i=document.createElement("a");i.href=o,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(o)},checkSize(e){const t=e.size/1048576;return t>10?{level:"error",message:"File is too large (>10MB). This may cause browser issues."}:t>5?{level:"warning",message:"Large file detected (>5MB). Processing may be slow."}:{level:"ok",message:null}},getExtension:e=>e.slice((e.lastIndexOf(".")-1>>>0)+2).toLowerCase()},DragDrop={init(e,t){const s=document.getElementById(e);s&&(s.addEventListener("dragover",e=>{e.preventDefault(),s.classList.add("dragover")}),s.addEventListener("dragleave",()=>{s.classList.remove("dragover")}),s.addEventListener("drop",e=>{e.preventDefault(),s.classList.remove("dragover");const r=e.dataTransfer.files;r.length>0&&t&&t(r[0])}))}},RecentTools={STORAGE_KEY:"codeutils-recent",MAX_ITEMS:10,get(){try{return JSON.parse(localStorage.getItem(this.STORAGE_KEY))||[]}catch{return[]}},add(e){const t=this.get().filter(t=>t.url!==e.url);t.unshift({...e,timestamp:Date.now()}),localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t.slice(0,this.MAX_ITEMS)))},clear(){localStorage.removeItem(this.STORAGE_KEY)}},Favorites={STORAGE_KEY:"codeutils-favorites",get(){try{return JSON.parse(localStorage.getItem(this.STORAGE_KEY))||[]}catch{return[]}},add(e){const t=this.get().filter(t=>t.url!==e.url);t.push(e),localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))},remove(e){const t=this.get().filter(t=>t.url!==e);localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))},toggle(e){return this.has(e.url)?(this.remove(e.url),!1):(this.add(e),!0)},has(e){return this.get().some(t=>t.url===e)},clear(){localStorage.removeItem(this.STORAGE_KEY)}},Shortcuts={handlers:{},register(e,t,s=!1,r=!1,o=!1){const i=this._getId(e,s,r,o);this.handlers[i]=t},_getId:(e,t,s,r)=>`${t?"ctrl+":""}${s?"alt+":""}${r?"shift+":""}${e.toLowerCase()}`,init(){document.addEventListener("keydown",e=>{const t=this._getId(e.key,e.ctrlKey,e.altKey,e.shiftKey),s=this.handlers[t];s&&(e.preventDefault(),s(e))})}},Search={tools:[],input:null,results:null,selectedIndex:-1,async init(e,t){if(this.input=document.getElementById(e),this.results=document.getElementById(t),this.input&&this.results){try{const e=await fetch("/data/tools.json");this.tools=await e.json()}catch(e){return void console.warn("Could not load tools data:",e)}this.input.addEventListener("input",()=>this.search()),this.input.addEventListener("focus",()=>{this.input.value.trim()&&this.search()}),this.input.addEventListener("keydown",e=>{"ArrowDown"===e.key?(e.preventDefault(),this.selectNext()):"ArrowUp"===e.key?(e.preventDefault(),this.selectPrev()):"Enter"===e.key?(e.preventDefault(),this.openSelected()):"Escape"===e.key&&(this.hide(),this.input.blur())}),document.addEventListener("click",e=>{this.input.contains(e.target)||this.results.contains(e.target)||this.hide()}),Shortcuts.register("/",()=>{this.input.focus()})}},search(){const e=this.input.value.trim().toLowerCase();if(!e)return void this.hide();const t=this.tools.filter(t=>t.name.toLowerCase().includes(e)||t.description.toLowerCase().includes(e)||t.keywords.some(t=>t.toLowerCase().includes(e))||t.category.toLowerCase().includes(e)).slice(0,8);this.showResults(t)},showResults(e){0===e.length?this.results.innerHTML='<div class="search-result-item"><p>No tools found</p></div>':this.results.innerHTML=e.map((e,t)=>`\n                <a href="${e.url}" class="search-result-item" data-index="${t}">\n                    <h4>${this.highlight(e.name)}<span class="category-tag">${e.category}</span></h4>\n                    <p>${e.description}</p>\n                </a>\n            `).join(""),this.results.classList.add("show"),this.selectedIndex=-1},highlight(e){const t=this.input.value.trim();if(!t)return e;const s=new RegExp(`(${t})`,"gi");return e.replace(s,"<strong>$1</strong>")},hide(){this.results.classList.remove("show"),this.selectedIndex=-1},selectNext(){const e=this.results.querySelectorAll(".search-result-item");0!==e.length&&(this.selectedIndex=Math.min(this.selectedIndex+1,e.length-1),this.updateSelection(e))},selectPrev(){const e=this.results.querySelectorAll(".search-result-item");0!==e.length&&(this.selectedIndex=Math.max(this.selectedIndex-1,0),this.updateSelection(e))},updateSelection(e){e.forEach((e,t)=>{e.classList.toggle("active",t===this.selectedIndex)})},openSelected(){const e=this.results.querySelectorAll(".search-result-item");this.selectedIndex>=0&&e[this.selectedIndex]&&(window.location.href=e[this.selectedIndex].href)}},Utils={debounce(e,t){let s;return function(...r){clearTimeout(s),s=setTimeout(()=>{clearTimeout(s),e(...r)},t)}},formatBytes(e,t=2){if(0===e)return"0 Bytes";const s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(t))+" "+["Bytes","KB","MB","GB"][s]},formatDate:e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),generateId:()=>Date.now().toString(36)+Math.random().toString(36).substr(2),escapeHtml(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}};document.addEventListener("DOMContentLoaded",()=>{Theme.init(),Shortcuts.init()}),window.CodeUtils={Theme:Theme,Message:Message,Clipboard:Clipboard,FileHandler:FileHandler,DragDrop:DragDrop,RecentTools:RecentTools,Favorites:Favorites,Shortcuts:Shortcuts,Search:Search,Utils:Utils};