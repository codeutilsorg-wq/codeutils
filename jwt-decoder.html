<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JWT Decoder | Decode JSON Web Tokens Online - Code Utils</title>
    <meta name="description" content="Decode and inspect JSON Web Tokens (JWT) without verification. View header, payload, and signature instantly. 100% private - tokens never leave your browser. Try it!">
    <meta name="keywords" content="jwt decoder, jwt parser, json web token, jwt debugger, decode jwt, jwt inspector, jwt online">
    <link rel="canonical" href="https://codeutils.org/jwt-decoder">

    <!-- Favicon and Touch Icons -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <meta name="theme-color" content="#3498db">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://codeutils.org/jwt-decoder">
    <meta property="og:title" content="JWT Decoder - Decode JSON Web Tokens Online - Code Utils">
    <meta property="og:description" content="Decode and inspect JSON Web Tokens instantly. View header, payload, and signature without verification. 100% private client-side processing.">
    <meta property="og:image" content="https://codeutils.org/images/og/jwt-decoder.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="JWT Decoder - Free online tool">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="JWT Decoder - Decode JSON Web Tokens Online - Code Utils">
    <meta name="twitter:description" content="Decode JWTs instantly with header and payload inspection. Free tool with 100% private processing.">
    <meta name="twitter:image" content="https://codeutils.org/images/og/jwt-decoder.png">

    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://www.googletagmanager.com">
    <link rel="dns-prefetch" href="https://www.googletagmanager.com">

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-RPHPBJ4291"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-RPHPBJ4291');
    </script>

    <!-- Structured Data: WebApplication Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "JWT Decoder - Code Utils",
      "applicationCategory": "DeveloperApplication",
      "operatingSystem": "Any",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "description": "Free JWT decoder and inspector. Decode JSON Web Tokens and view header, payload, and signature without verification. 100% client-side processing.",
      "url": "https://codeutils.org/jwt-decoder",
      "browserRequirements": "Requires JavaScript. Requires HTML5.",
      "softwareVersion": "1.0",
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.6",
        "ratingCount": "1180"
      }
    }
    </script>

    <!-- Structured Data: FAQ Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "Does this tool verify JWT signatures?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "No, this tool only decodes JWTs—it does not verify signatures. Signature verification requires the signing key which varies by system. Decoding shows you what data is in the token, but does not confirm the token's authenticity or that it hasn't been tampered with. Always verify JWT signatures on your server before trusting the token's contents. Never make security decisions based solely on decoded JWT data without signature verification."
          }
        },
        {
          "@type": "Question",
          "name": "How do I check if a JWT is expired?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "JWTs contain an 'exp' claim that specifies the expiration time as a Unix timestamp (seconds since epoch). This tool automatically checks the expiration time and displays whether the token is valid or expired. Simply decode the JWT using this tool and look for the expiration status in the payload output. If the current time is greater than the exp value, the token is expired. Your server must also validate expiration before accepting the token."
          }
        },
        {
          "@type": "Question",
          "name": "What are JWT claims and which ones matter?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "JWT claims are pieces of information stored in the payload (the middle part of a JWT). Standard claims include: sub (subject/user ID), iss (issuer), aud (audience), exp (expiration time), iat (issued at time), nbf (not before time), and jti (unique identifier). Custom claims specific to your application can also be included. When debugging tokens, check the 'exp' and 'sub' claims first to verify the token isn't expired and belongs to the correct user."
          }
        },
        {
          "@type": "Question",
          "name": "Can I modify or create a JWT with this tool?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "No, this tool only decodes JWTs. You cannot modify or create new tokens here. To create or modify JWTs, use backend code or specialized JWT tools that handle signing. Any JWT created without the proper signature will be rejected by your server. If you decode a JWT and want to see how changes would affect it, modify the payload values conceptually and re-encode manually, but understand this wouldn't be a valid token without proper signing."
          }
        },
        {
          "@type": "Question",
          "name": "When and why should I use JWTs for authentication?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "JWTs are ideal for stateless authentication in modern web and mobile applications, APIs, and microservices. They contain all user information in the token itself, eliminating the need for server-side session storage. JWTs are URL-safe, can be easily transmitted in headers, and work well with CORS and cross-domain requests. However, JWTs require HTTPS to prevent interception, proper signature verification on the server, and careful management of sensitive information in the payload (don't include passwords or secrets)."
          }
        },
        {
          "@type": "Question",
          "name": "What are the three parts of a JWT and what do they mean?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "A JWT has three parts separated by dots: Header (specifies token type and signing algorithm), Payload (contains the actual data/claims including user info and expiration), and Signature (cryptographically proves the token hasn't been tampered with). The header and payload are Base64-encoded and human-readable. The signature can only be verified with the secret key. This tool decodes and displays all three parts so you can inspect the data and signature value."
          }
        }
      ]
    }
    </script>

    <link rel="stylesheet" href="css/common.min.css">
    <style>
        .jwt-section {
            margin-bottom: var(--spacing-md);
        }
        .jwt-section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-sm) var(--spacing-md);
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-bottom: none;
            border-radius: var(--radius) var(--radius) 0 0;
            font-weight: 600;
        }
        .jwt-section-header.header-section { color: #e74c3c; }
        .jwt-section-header.payload-section { color: #9b59b6; }
        .jwt-section-header.signature-section { color: #3498db; }
        .jwt-section-content {
            padding: var(--spacing-md);
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 0 0 var(--radius) var(--radius);
            font-family: var(--font-mono);
            font-size: 0.875rem;
            white-space: pre-wrap;
            word-break: break-all;
            min-height: 80px;
        }
        .claim-row {
            display: flex;
            padding: var(--spacing-xs) 0;
            border-bottom: 1px solid var(--border);
        }
        .claim-row:last-child {
            border-bottom: none;
        }
        .claim-name {
            font-weight: 600;
            min-width: 120px;
            color: var(--primary);
        }
        .claim-value {
            flex: 1;
            word-break: break-all;
        }
        .claim-description {
            color: var(--text-secondary);
            font-size: 0.75rem;
            margin-left: var(--spacing-xs);
        }
        .expiry-warning {
            color: #e74c3c;
            font-weight: 600;
        }
        .expiry-valid {
            color: #27ae60;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="index.html" class="header-logo">
                <h1>Code Utils</h1>
            </a>
            <nav class="header-nav">
                <a href="index.html" class="btn btn-outline btn-sm">All Tools</a>
                <button class="theme-toggle" onclick="CodeUtils.Theme.toggle()">Toggle Dark Mode</button>
            </nav>
        </div>
    </header>

    <div class="container">
        <div class="card" style="margin-bottom: var(--spacing-md); padding: var(--spacing-md);">
            <h2 style="margin-bottom: var(--spacing-xs); color: var(--primary);">JWT Decoder</h2>
            <p style="margin: 0; color: var(--text-secondary);">Instantly decode and inspect JSON Web Tokens (JWTs) to view their header, payload, and signature without server-side verification. JWTs are used extensively in modern authentication systems, APIs, microservices, and single-page applications (SPAs) for secure, stateless authentication. This tool helps you quickly debug authentication issues, verify token contents, check expiration times, and inspect claims. Simply paste your JWT token and instantly see the decoded data with automatic expiration status checking. All processing happens completely securely in your browser—tokens never leave your computer or touch our servers. Perfect for developers, DevOps engineers, and security professionals debugging JWT-based authentication systems. Note: This tool decodes tokens for inspection only; it does not verify signatures. Always verify JWT signatures on your server before trusting token contents.</p>
        </div>

        <div class="controls">
            <div class="controls-group">
                <button class="btn" onclick="decodeJWT()" title="Decode JWT (Ctrl+Enter)">Decode</button>
            </div>
            <div class="controls-group">
                <button class="btn btn-secondary" onclick="copyDecoded()" title="Copy Decoded (Ctrl+K)">Copy Decoded</button>
                <button class="btn btn-secondary" onclick="loadSample()">Load Sample</button>
            </div>
            <button class="btn btn-outline" onclick="clearAll()">Clear</button>
        </div>

        <div id="message" class="message"></div>

        <div class="editor-section" style="margin-bottom: var(--spacing-md);">
            <div class="editor-header">JWT Token</div>
            <textarea id="inputJWT" class="editor" placeholder="Paste your JWT token here..." style="min-height: 100px;"></textarea>
        </div>

        <div id="decodedOutput">
            <div class="jwt-section">
                <div class="jwt-section-header header-section">
                    <span>Header</span>
                    <button class="btn btn-sm btn-outline" onclick="copySection('header')">Copy</button>
                </div>
                <div class="jwt-section-content" id="headerOutput">Decoded header will appear here...</div>
            </div>

            <div class="jwt-section">
                <div class="jwt-section-header payload-section">
                    <span>Payload</span>
                    <button class="btn btn-sm btn-outline" onclick="copySection('payload')">Copy</button>
                </div>
                <div class="jwt-section-content" id="payloadOutput">Decoded payload will appear here...</div>
            </div>

            <div class="jwt-section">
                <div class="jwt-section-header signature-section">
                    <span>Signature</span>
                    <button class="btn btn-sm btn-outline" onclick="copySection('signature')">Copy</button>
                </div>
                <div class="jwt-section-content" id="signatureOutput">Signature will appear here...</div>
            </div>
        </div>

        <!-- Related Tools -->
        <div class="related-tools">
            <h3>Related Tools</h3>
            <ul class="related-tools-list">
                <li><a href="base64-encoder.html">Base64 Encoder/Decoder</a></li>
                <li><a href="json-formatter.html">JSON Formatter</a></li>
                <li><a href="hash-generator.html">Hash Generator</a></li>
                <li><a href="timestamp-converter.html">Timestamp Converter</a></li>
            </ul>
        </div>

        <!-- Info Section -->
        <div class="info-section">
            <h2>About JWT Decoder</h2>
            <p>JSON Web Tokens (JWTs) are a standard for securely transmitting information as JSON objects in authentication systems, APIs, and microservices architectures. This tool provides a fast, secure way to decode and inspect JWTs by extracting and displaying the header, payload, and signature information. JWTs are stateless, URL-safe, and work seamlessly across domains, making them ideal for modern web applications, mobile apps, and APIs. Whether you're debugging authentication issues, verifying user claims, checking token expiration, or understanding API authentication flows, this decoder simplifies JWT inspection with an instant, privacy-first approach.</p>

            <h3>Key Features</h3>
            <ul>
                <li><strong>Decode All JWT Parts:</strong> Instantly extract and display header, payload, and signature from any JWT token</li>
                <li><strong>Automatic Expiration Check:</strong> Automatically detects and displays whether a token is expired or still valid</li>
                <li><strong>Claim Analysis:</strong> Identifies and displays standard JWT claims (sub, iss, exp, iat, aud, nbf, jti) and custom claims</li>
                <li><strong>Formatted Output:</strong> Displays decoded JSON data with proper formatting for easy readability</li>
                <li><strong>Timestamp Conversion:</strong> Automatically converts Unix timestamps (iat, exp, nbf) to human-readable dates</li>
                <li><strong>One-Click Copy:</strong> Copy individual sections (header, payload, signature) or all decoded data to clipboard</li>
                <li><strong>Sample JWT:</strong> Load a sample token to learn JWT structure without needing your own token</li>
                <li><strong>100% Client-Side:</strong> All decoding happens in your browser—tokens never leave your computer</li>
            </ul>

            <h3>How to Use This Tool</h3>

            <p><strong>Method 1: Decode Your JWT</strong></p>
            <ol>
                <li>Copy your JWT token from your authentication system, API response, or browser storage</li>
                <li>Paste it into the "JWT Token" text area</li>
                <li>Click the "Decode" button (or press Ctrl+Enter) to instantly decode</li>
                <li>View the decoded header, payload, and signature in the output sections below</li>
                <li>Check the expiration status—automatically shown if the token has an exp claim</li>
            </ol>

            <p><strong>Method 2: Inspect Individual Token Parts</strong></p>
            <ol>
                <li>After decoding, each section (Header, Payload, Signature) displays separately for easy inspection</li>
                <li>Click the "Copy" button on any section to copy just that part</li>
                <li>Use the "Copy Decoded" button to copy all three parts together as formatted text</li>
            </ol>

            <p><strong>Method 3: Learn with Sample Token</strong></p>
            <ol>
                <li>Click the "Load Sample" button to pre-load an example JWT</li>
                <li>Click "Decode" to see how a valid JWT token is structured</li>
                <li>Examine the header, payload, and claims to understand JWT format</li>
            </ol>

            <p><strong>Keyboard Shortcuts (Power Users)</strong></p>
            <ul>
                <li><strong>Ctrl + Enter</strong> - Decode JWT token</li>
                <li><strong>Ctrl + K</strong> - Copy all decoded output</li>
                <li><strong>Paste</strong> - Auto-decode when you paste a JWT</li>
            </ul>

            <p><em>Pro tip: This tool auto-decodes when you paste a JWT, so you can quickly inspect tokens from your clipboard without manually clicking decode.</em></p>

            <h3>Common Use Cases</h3>

            <p><strong>Debugging Authentication and Authorization Issues</strong></p>
            <p>When users report authentication problems or receive "unauthorized" errors, extract their JWT and decode it using this tool to verify the token contents, check expiration status, and confirm claims (sub for user ID, roles for authorization). Often you'll discover tokens are expired, missing required claims, or contain incorrect values—information that's impossible to see without decoding. This tool instantly reveals the underlying issue without needing server logs.</p>

            <p><strong>Verifying User Claims in SPA Applications</strong></p>
            <p>Single-page applications (SPAs) that store JWTs in localStorage or sessionStorage often need to inspect what user data is stored in the token. Decode the JWT to verify the user ID, email, roles, permissions, and other claims are correctly set. This is essential when debugging authorization issues where a user claims they should have certain permissions but the token doesn't contain the expected claims.</p>

            <p><strong>Inspecting API Response Tokens</strong></p>
            <p>When testing APIs that return JWTs in responses (especially OAuth2 or OpenID Connect flows), paste the returned token here to instantly see what the API included in the token. Verify that all expected claims are present, user information is correct, and the token hasn't expired. This speeds up API development and testing significantly compared to manually decoding tokens on the server.</p>

            <p><strong>Understanding JWT Structure for Development and Learning</strong></p>
            <p>New developers learning about JWT authentication can use this tool to understand the three-part structure (Header.Payload.Signature), see real token examples, and learn what information JWTs typically contain. The sample token feature provides a hands-on way to explore JWTs without requiring access to a live authentication system.</p>

            <h3>Tips & Best Practices</h3>
            <ul>
                <li><strong>Always verify on the server:</strong> This tool only decodes—it doesn't verify signatures. Never make security decisions based solely on decoded content. Always verify JWT signatures on your backend</li>
                <li><strong>Check expiration first:</strong> When debugging authentication, the expiration (exp) claim is often the culprit. This tool automatically shows expiration status</li>
                <li><strong>Inspect the aud claim:</strong> If your JWT has an 'aud' (audience) claim, verify it matches your application. Mismatched audience claims are a common configuration issue</li>
                <li><strong>Never log JWTs in production:</strong> While this tool is safe and private, avoid logging tokens in production applications where they could be exposed in log files</li>
                <li><strong>Watch for custom claims:</strong> Different applications add custom claims beyond standard ones. Document what custom claims your system uses to better understand decoded tokens</li>
                <li><strong>Use HTTPS always:</strong> JWTs offer no inherent security—they're just formatted data. Always transmit JWTs over HTTPS to prevent interception</li>
            </ul>

            <h3>Frequently Asked Questions</h3>

            <p><strong>Q: Does this tool verify JWT signatures?</strong></p>
            <p>A: No, this tool only decodes JWTs—it does not verify signatures. Signature verification requires the signing key which varies by system. Decoding shows you what data is in the token, but does not confirm the token's authenticity or that it hasn't been tampered with. Always verify JWT signatures on your server before trusting the token's contents. Never make security decisions based solely on decoded JWT data without signature verification.</p>

            <p><strong>Q: How do I check if a JWT is expired?</strong></p>
            <p>A: JWTs contain an 'exp' claim that specifies the expiration time as a Unix timestamp (seconds since epoch). This tool automatically checks the expiration time and displays whether the token is valid or expired. Simply decode the JWT using this tool and look for the expiration status in the payload output. If the current time is greater than the exp value, the token is expired. Your server must also validate expiration before accepting the token.</p>

            <p><strong>Q: What are JWT claims and which ones matter?</strong></p>
            <p>A: JWT claims are pieces of information stored in the payload (the middle part of a JWT). Standard claims include: sub (subject/user ID), iss (issuer), aud (audience), exp (expiration time), iat (issued at time), nbf (not before time), and jti (unique identifier). Custom claims specific to your application can also be included. When debugging tokens, check the 'exp' and 'sub' claims first to verify the token isn't expired and belongs to the correct user.</p>

            <p><strong>Q: Can I modify or create a JWT with this tool?</strong></p>
            <p>A: No, this tool only decodes JWTs. You cannot modify or create new tokens here. To create or modify JWTs, use backend code or specialized JWT tools that handle signing. Any JWT created without the proper signature will be rejected by your server. If you decode a JWT and want to see how changes would affect it, modify the payload values conceptually and re-encode manually, but understand this wouldn't be a valid token without proper signing.</p>

            <p><strong>Q: When and why should I use JWTs for authentication?</strong></p>
            <p>A: JWTs are ideal for stateless authentication in modern web and mobile applications, APIs, and microservices. They contain all user information in the token itself, eliminating the need for server-side session storage. JWTs are URL-safe, can be easily transmitted in headers, and work well with CORS and cross-domain requests. However, JWTs require HTTPS to prevent interception, proper signature verification on the server, and careful management of sensitive information in the payload (don't include passwords or secrets).</p>

            <p><strong>Q: What are the three parts of a JWT and what do they mean?</strong></p>
            <p>A: A JWT has three parts separated by dots: Header (specifies token type and signing algorithm), Payload (contains the actual data/claims including user info and expiration), and Signature (cryptographically proves the token hasn't been tampered with). The header and payload are Base64-encoded and human-readable. The signature can only be verified with the secret key. This tool decodes and displays all three parts so you can inspect the data and signature value.</p>

            <h3>Understanding JWT Security</h3>
            <p>JWTs are not encrypted by default—they are only Base64-encoded and signed. Anyone can decode a JWT to see its contents, which is why sensitive information like passwords should never be stored in JWT claims. The signature proves the token came from a trusted source and hasn't been modified, but only if verified with the correct signing key. Always use HTTPS when transmitting JWTs to prevent interception, and always verify signatures on your server before trusting the token's claims.</p>
        </div>
    </div>

    <footer class="footer">
        <p>&copy; 2025 Code Utils. All rights reserved.</p>
        <p>Free developer utilities - 100% client-side processing</p>
    </footer>

    <script src="js/common.min.js"></script>
    <script>
        // Track this tool visit
        CodeUtils.RecentTools.add({
            id: 'jwt-decoder',
            name: 'JWT Decoder',
            url: 'jwt-decoder.html'
        });

        // DOM elements
        const inputJWT = document.getElementById('inputJWT');
        const headerOutput = document.getElementById('headerOutput');
        const payloadOutput = document.getElementById('payloadOutput');
        const signatureOutput = document.getElementById('signatureOutput');

        // Store decoded data
        let decodedData = {
            header: null,
            payload: null,
            signature: null
        };

        // Initialize message handler
        CodeUtils.Message.init('message');

        // Base64URL decode
        function base64UrlDecode(str) {
            // Replace URL-safe characters
            let base64 = str.replace(/-/g, '+').replace(/_/g, '/');
            // Pad with '=' if necessary
            const pad = base64.length % 4;
            if (pad) {
                base64 += '='.repeat(4 - pad);
            }
            // Decode
            try {
                return decodeURIComponent(atob(base64).split('').map(c => {
                    return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
                }).join(''));
            } catch (e) {
                return atob(base64);
            }
        }

        // Format timestamp
        function formatTimestamp(timestamp) {
            if (!timestamp) return '';
            const date = new Date(timestamp * 1000);
            return date.toLocaleString() + ' (' + date.toISOString() + ')';
        }

        // Check if expired
        function isExpired(exp) {
            if (!exp) return null;
            return Date.now() > exp * 1000;
        }

        // Decode JWT
        function decodeJWT() {
            const token = inputJWT.value.trim();
            if (!token) {
                CodeUtils.Message.error('Please enter a JWT token');
                return;
            }

            const parts = token.split('.');
            if (parts.length !== 3) {
                CodeUtils.Message.error('Invalid JWT format. JWT should have 3 parts separated by dots.');
                return;
            }

            try {
                // Decode header
                const headerStr = base64UrlDecode(parts[0]);
                decodedData.header = JSON.parse(headerStr);
                headerOutput.textContent = JSON.stringify(decodedData.header, null, 2);

                // Decode payload
                const payloadStr = base64UrlDecode(parts[1]);
                decodedData.payload = JSON.parse(payloadStr);

                // Format payload with claim descriptions
                let payloadDisplay = JSON.stringify(decodedData.payload, null, 2);

                // Add expiry status
                if (decodedData.payload.exp) {
                    const expired = isExpired(decodedData.payload.exp);
                    const expiryDate = formatTimestamp(decodedData.payload.exp);
                    payloadDisplay += '\n\n--- Token Status ---\n';
                    payloadDisplay += 'Expires: ' + expiryDate + '\n';
                    payloadDisplay += 'Status: ' + (expired ? 'EXPIRED' : 'VALID');
                }

                if (decodedData.payload.iat) {
                    if (!payloadDisplay.includes('--- Token Status ---')) {
                        payloadDisplay += '\n\n--- Token Status ---\n';
                    }
                    payloadDisplay += '\nIssued: ' + formatTimestamp(decodedData.payload.iat);
                }

                payloadOutput.textContent = payloadDisplay;

                // Show signature (cannot decode, just display)
                decodedData.signature = parts[2];
                signatureOutput.textContent = parts[2];

                CodeUtils.Message.success('JWT decoded successfully!');

            } catch (error) {
                CodeUtils.Message.error('Error decoding JWT: ' + error.message);
                headerOutput.textContent = 'Error decoding header';
                payloadOutput.textContent = 'Error decoding payload';
                signatureOutput.textContent = '';
            }
        }

        // Copy section
        async function copySection(section) {
            let content;
            switch (section) {
                case 'header':
                    content = decodedData.header ? JSON.stringify(decodedData.header, null, 2) : '';
                    break;
                case 'payload':
                    content = decodedData.payload ? JSON.stringify(decodedData.payload, null, 2) : '';
                    break;
                case 'signature':
                    content = decodedData.signature || '';
                    break;
            }

            if (!content) {
                CodeUtils.Message.error('Nothing to copy');
                return;
            }

            try {
                await CodeUtils.Clipboard.copy(content);
                CodeUtils.Message.success('Copied to clipboard!');
            } catch (err) {
                CodeUtils.Message.error(err.message);
            }
        }

        // Copy all decoded
        async function copyDecoded() {
            if (!decodedData.header || !decodedData.payload) {
                CodeUtils.Message.error('Nothing to copy. Decode a JWT first.');
                return;
            }

            const content = `=== HEADER ===\n${JSON.stringify(decodedData.header, null, 2)}\n\n=== PAYLOAD ===\n${JSON.stringify(decodedData.payload, null, 2)}\n\n=== SIGNATURE ===\n${decodedData.signature}`;

            try {
                await CodeUtils.Clipboard.copy(content);
                CodeUtils.Message.success('Copied to clipboard!');
            } catch (err) {
                CodeUtils.Message.error(err.message);
            }
        }

        // Load sample JWT
        function loadSample() {
            // Sample JWT (expired, for demo purposes)
            const sampleJWT = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWUsImlhdCI6MTUxNjIzOTAyMiwiZXhwIjoxNTE2MjQyNjIyfQ.POstGetfAytaZS82wHcjoTyoqhMyxXiWdR7Nn7A29DNSl0EiXLdwJ6xC6AfgZWF1bOsS_TuYI3OG85AmiExREkrS6tDfTQ2B3WXlrr-wp5AokiRbz3_oB4OxG-W9KcEEbDRcZc0nH3L7LzYptiy1PtAylQGxHTWZXtGz4ht0bAecBgmpdgXMguEIcoqPJ1n3pIWk_dUZegpqx0Lka21H6XxUTxiy8OcaarA8zdnPUnV6AmNP3ecFawIFYdvJB_cm-GvpCSbr8G8y_Mllj8f4x9nBH8pQux89_6gUY618iYv7tuPWBFfEbLxtF2pZS6YC1aSfLQxeNe8djT9YjpvRZA';
            inputJWT.value = sampleJWT;
            decodeJWT();
        }

        // Clear all
        function clearAll() {
            inputJWT.value = '';
            headerOutput.textContent = 'Decoded header will appear here...';
            payloadOutput.textContent = 'Decoded payload will appear here...';
            signatureOutput.textContent = 'Signature will appear here...';
            decodedData = { header: null, payload: null, signature: null };
            CodeUtils.Message.hide();
        }

        // Keyboard shortcuts
        CodeUtils.Shortcuts.register('Enter', decodeJWT, true);
        CodeUtils.Shortcuts.register('k', copyDecoded, true);

        // Auto-decode on paste
        inputJWT.addEventListener('paste', () => {
            setTimeout(decodeJWT, 100);
        });
    </script>
</body>
</html>
