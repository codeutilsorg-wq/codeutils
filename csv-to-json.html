<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- CRITICAL: Apply theme immediately to prevent flash -->
    <script>
        (function() {
            const theme = localStorage.getItem('codeutils-theme');
            if (theme === 'light') {
                document.documentElement.classList.add('light-mode');
            }
        })();
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSV to JSON Converter | Convert Spreadsheets - Code Utils</title>
    <meta name="description" content="Convert CSV files to JSON format instantly. Supports custom delimiters, headers, and Excel exports. Download or copy results. 100% private processing. Convert now!">
    <meta name="keywords" content="csv to json, convert csv json, csv json converter, csv parser, spreadsheet to json">
    <link rel="canonical" href="https://codeutils.org/csv-to-json">

    <!-- Favicon and Touch Icons -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <meta name="theme-color" content="#3498db">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://codeutils.org/csv-to-json">
    <meta property="og:title" content="CSV to JSON Converter - Code Utils">
    <meta property="og:description" content="Convert CSV files to JSON format with custom delimiters and header options. 100% private client-side processing.">
    <meta property="og:image" content="https://codeutils.org/images/og/csv-to-json.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="CSV to JSON Converter - Free online tool">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="CSV to JSON Converter - Code Utils">
    <meta name="twitter:description" content="Convert CSV to JSON instantly. Free tool with 100% private processing.">
    <meta name="twitter:image" content="https://codeutils.org/images/og/csv-to-json.png">

    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://www.googletagmanager.com">
    <link rel="dns-prefetch" href="https://www.googletagmanager.com">

        <!-- Google Analytics (only load in production) -->
    <script>
        // Only load Google Analytics if NOT on localhost
        if (window.location.hostname !== 'localhost' && window.location.hostname !== '127.0.0.1') {
            // Load gtag.js
            var script = document.createElement('script');
            script.async = true;
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-RPHPBJ4291';
            document.head.appendChild(script);

            // Initialize GA
            window.dataLayer = window.dataLayer || [];
            function gtag() { dataLayer.push(arguments); }
            gtag('js', new Date());
            gtag('config', 'G-RPHPBJ4291');
        } else {
            // Mock gtag function for localhost (prevents errors)
            window.gtag = function() {
                console.log('GA (localhost - not tracked):', arguments);
            };
        }
    </script>

    <!-- Structured Data: WebApplication Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "CSV to JSON Converter - Code Utils",
      "applicationCategory": "DeveloperApplication",
      "operatingSystem": "Any",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "description": "Free CSV to JSON converter. Convert CSV data to JSON format with custom delimiters and header options. 100% client-side processing.",
      "url": "https://codeutils.org/csv-to-json",
      "browserRequirements": "Requires JavaScript. Requires HTML5.",
      "softwareVersion": "1.0"
    }
    </script>
    <!-- Structured Data: FAQ Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "Does the converter handle CSV files with quoted fields containing commas?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes. The converter correctly parses RFC 4180-compliant CSV where fields containing commas, newlines, or double quotes are enclosed in double quotes. For example, \"Smith, John\" is treated as a single field, not split at the comma."
          }
        },
        {
          "@type": "Question",
          "name": "What if my CSV has no header row?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Uncheck the \"First row is headers\" option. The converter will generate numeric keys (0, 1, 2...) for each column instead of using the first row as keys."
          }
        },
        {
          "@type": "Question",
          "name": "Is my CSV data private?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes. All conversion happens in your browser using JavaScript. Your data is never uploaded to any server, stored, or transmitted anywhere."
          }
        },
        {
          "@type": "Question",
          "name": "Do I need to sign up to use this?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "No. The tool is completely free with no registration required."
          }
        }
      ]
    }
    </script>
    <!-- Structured Data: HowTo Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "HowTo",
      "name": "How to Use CSV to JSON Converter | Convert Spreadsheets Online",
      "description": "Step-by-step guide to using the free online CSV to JSON Converter | Convert Spreadsheets tool at codeutils.org",
      "step": [
        {
          "@type": "HowToStep",
          "position": 1,
          "name": "Copy your CSV data from Excel, Google Sheets, or any text...",
          "text": "Copy your CSV data from Excel, Google Sheets, or any text editor"
        },
        {
          "@type": "HowToStep",
          "position": 2,
          "name": "Paste it into the input area",
          "text": "Paste it into the input area"
        },
        {
          "@type": "HowToStep",
          "position": 3,
          "name": "The delimiter is auto-detected, or you can select it manu...",
          "text": "The delimiter is auto-detected, or you can select it manually"
        },
        {
          "@type": "HowToStep",
          "position": 4,
          "name": "Enable \"Parse numbers\" and \"Parse booleans\" if you want p...",
          "text": "Enable \"Parse numbers\" and \"Parse booleans\" if you want proper JSON types"
        },
        {
          "@type": "HowToStep",
          "position": 5,
          "name": "Click \"Convert\" to generate JSON output",
          "text": "Click \"Convert\" to generate JSON output"
        }
      ]
    }
    </script>

    <link rel="stylesheet" href="css/common.css">
    <style>
        .options-row {
            display: flex;
            gap: var(--spacing-md);
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: var(--spacing-md);
        }
        .options-row label {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
        }
        .options-row select {
            padding: var(--spacing-xs) var(--spacing-sm);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            background: var(--bg-secondary);
            color: var(--text-primary);
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="index.html" class="header-logo">
                <h1>Code Utils</h1>
            </a>
            <nav class="header-nav">
                <a href="index.html" class="btn btn-outline btn-sm">All Tools</a>
                <button class="theme-toggle" onclick="CodeUtils.Theme.toggle()">Toggle Dark Mode</button>
            </nav>
        </div>
    </header>

    <div class="container">
        <div class="card" style="margin-bottom: var(--spacing-md); padding: var(--spacing-md);">
            <h2 style="margin-bottom: var(--spacing-xs); color: var(--primary);">CSV to JSON Converter</h2>
            <p style="margin: 0; color: var(--text-secondary);">Convert CSV data to JSON format.</p>
        </div>

        <div class="editor-section">
            <div class="editor-header">CSV Input</div>
            <textarea id="csvInput" class="editor" placeholder="name,age,city
John,30,NYC
Jane,25,LA"></textarea>
        </div>

        <div class="options-row">
            <label>
                Delimiter:
                <select id="delimiter">
                    <option value=",">Comma (,)</option>
                    <option value=";">Semicolon (;)</option>
                    <option value="\t">Tab</option>
                    <option value="|">Pipe (|)</option>
                    <option value="auto">Auto-detect</option>
                </select>
            </label>
            <label>
                <input type="checkbox" id="hasHeaders" checked>
                First row is headers
            </label>
            <label>
                <input type="checkbox" id="parseNumbers" checked>
                Parse numbers
            </label>
            <label>
                <input type="checkbox" id="parseBooleans" checked>
                Parse booleans
            </label>
        </div>

        <div class="controls">
            <button class="btn" onclick="convertToJSON()">Convert to JSON</button>
            <button class="btn btn-secondary" onclick="copyJSON()">Copy JSON</button>
            <button class="btn btn-secondary" onclick="downloadJSON()">Download JSON</button>
            <button class="btn btn-outline" onclick="clearAll()">Clear</button>
        </div>

        <div id="message" class="message"></div>

        <div class="editor-section">
            <div class="editor-header">JSON Output</div>
            <textarea id="jsonOutput" class="editor" readonly placeholder="JSON output will appear here..."></textarea>
        </div>

        <!-- Related Tools -->
        <div class="related-tools">
            <h3>Related Tools</h3>
            <div class="related-tools-grid">
                <a href="json-to-csv.html" class="related-tool-card">
                    <span class="related-tool-icon">J>C</span>
                    <span class="related-tool-name">JSON to CSV</span>
                </a>
                <a href="json-formatter.html" class="related-tool-card">
                    <span class="related-tool-icon">{ }</span>
                    <span class="related-tool-name">JSON Formatter</span>
                </a>
                <a href="yaml-to-json.html" class="related-tool-card">
                    <span class="related-tool-icon">Y>J</span>
                    <span class="related-tool-name">YAML to JSON</span>
                </a>
                <a href="xml-to-json.html" class="related-tool-card">
                    <span class="related-tool-icon">X>J</span>
                    <span class="related-tool-name">XML to JSON</span>
                </a>
            </div>
        </div>

        <div class="info-section">
            <h2>About CSV to JSON Converter</h2>
            <p>CSV is the universal format for spreadsheet exports, database dumps, and data pipelines—but modern web applications and APIs work with JSON. Manually converting CSV rows to JSON objects is repetitive and error-prone for anything beyond a few rows. Our CSV to JSON Converter instantly transforms any CSV data into a properly structured JSON array, with options to auto-detect delimiters, control type parsing, and handle headers. Paste your CSV or upload a file and get clean JSON output in seconds, entirely in your browser.</p>

            <h3>Key Features</h3>
            <ul>
                <li><strong>Auto-Detect Delimiter:</strong> Automatically identifies comma, semicolon, tab, or pipe delimiters—no manual configuration needed</li>
                <li><strong>Header Row Support:</strong> Use the first row as JSON object keys, or generate automatic numeric keys</li>
                <li><strong>Type Parsing:</strong> Optionally convert numeric strings to numbers and "true"/"false" strings to booleans for proper JSON typing</li>
                <li><strong>Pretty-Printed Output:</strong> JSON output is formatted with indentation for easy reading and validation</li>
                <li><strong>File Upload:</strong> Upload .csv files directly instead of copy-pasting</li>
                <li><strong>Download as JSON:</strong> Save the output as a .json file with one click</li>
                <li><strong>Privacy First:</strong> 100% client-side processing—your data never leaves your browser</li>
            </ul>

            <h3>How to Use This Tool</h3>

            <p><strong>Method 1: Paste CSV Data</strong></p>
            <ol>
                <li>Copy your CSV data from Excel, Google Sheets, or any text editor</li>
                <li>Paste it into the input area</li>
                <li>The delimiter is auto-detected, or you can select it manually</li>
                <li>Enable "Parse numbers" and "Parse booleans" if you want proper JSON types</li>
                <li>Click "Convert" to generate JSON output</li>
                <li>Copy the JSON or download it as a .json file</li>
            </ol>

            <p><strong>Method 2: Upload a CSV File</strong></p>
            <ol>
                <li>Click "Upload" or drag and drop a .csv file</li>
                <li>Configure options as needed</li>
                <li>JSON output generates automatically</li>
                <li>Download or copy the result</li>
            </ol>

            <h3>Common Use Cases</h3>

            <p><strong>Importing Spreadsheet Data into Web Applications</strong></p>
            <p>When users export data from Excel or Google Sheets as CSV to upload to a web application, the application often needs JSON for its API. Convert the exported CSV to JSON here for quick testing and prototyping, or use this as a reference for implementing the conversion in your application's backend. The type-parsing options ensure that numeric values like prices and quantities are proper numbers rather than strings in the output.</p>

            <p><strong>Database Export to API Format</strong></p>
            <p>Relational databases export query results as CSV. When you need to seed a NoSQL database, mock an API response, or share structured data with a frontend developer, convert the CSV export to JSON here. Each CSV row becomes a JSON object with column headers as keys—exactly the format most APIs return and consume.</p>

            <p><strong>Data Transformation for Analysis</strong></p>
            <p>Python and JavaScript data processing scripts often work more naturally with JSON than CSV. Convert your CSV dataset to JSON to use with JavaScript's built-in JSON.parse(), or to create test fixtures for unit tests. The pretty-printed output makes it easy to inspect the structure and verify the conversion before using the data in your code.</p>

            <h3>Tips &amp; Best Practices</h3>
            <ul>
                <li><strong>Enable type parsing for numeric data:</strong> Without it, every value is a string—"30" instead of 30—which causes issues when doing arithmetic or comparisons in code. Always enable "Parse numbers" when your data contains numeric values</li>
                <li><strong>Check for quoted fields with commas:</strong> Well-formed CSV wraps values containing commas in double quotes—the converter handles this correctly. If your CSV uses a different quoting convention, verify the output carefully</li>
                <li><strong>Use tab delimiter for Excel copy-paste:</strong> Copying cells from Excel and pasting into text produces tab-separated data. If auto-detect fails, manually select "Tab" as the delimiter</li>
                <li><strong>Validate the JSON output:</strong> For large or complex CSVs, paste the output into a JSON formatter or validator to confirm the structure is correct before using it in production</li>
            </ul>

            <h3>Frequently Asked Questions</h3>

            <p><strong>Q: Does the converter handle CSV files with quoted fields containing commas?</strong></p>
            <p>A: Yes. The converter correctly parses RFC 4180-compliant CSV where fields containing commas, newlines, or double quotes are enclosed in double quotes. For example, "Smith, John" is treated as a single field, not split at the comma.</p>

            <p><strong>Q: What if my CSV has no header row?</strong></p>
            <p>A: Uncheck the "First row is headers" option. The converter will generate numeric keys (0, 1, 2...) for each column instead of using the first row as keys.</p>

            <p><strong>Q: Is my CSV data private?</strong></p>
            <p>A: Yes. All conversion happens in your browser using JavaScript. Your data is never uploaded to any server, stored, or transmitted anywhere.</p>

            <p><strong>Q: Do I need to sign up to use this?</strong></p>
            <p>A: No. The tool is completely free with no registration required.</p>
        </div>
    </div>

    <footer class="footer">
        <p>&copy; 2025 Code Utils. All rights reserved.</p>
        <p>Free developer utilities - 100% client-side processing</p>
    </footer>

    <script src="js/common.js"></script>
    <script>
        CodeUtils.RecentTools.add({
            id: 'csv-to-json',
            name: 'CSV to JSON',
            url: 'csv-to-json.html'
        });

        CodeUtils.Message.init('message');

        function detectDelimiter(csv) {
            const firstLine = csv.split('\n')[0];
            const delimiters = [',', ';', '\t', '|'];
            let maxCount = 0;
            let detected = ',';

            for (const d of delimiters) {
                const count = (firstLine.match(new RegExp(d === '|' ? '\\|' : d, 'g')) || []).length;
                if (count > maxCount) {
                    maxCount = count;
                    detected = d;
                }
            }
            return detected;
        }

        function parseCSVLine(line, delimiter) {
            const result = [];
            let current = '';
            let inQuotes = false;

            for (let i = 0; i < line.length; i++) {
                const char = line[i];

                if (char === '"') {
                    if (inQuotes && line[i + 1] === '"') {
                        current += '"';
                        i++;
                    } else {
                        inQuotes = !inQuotes;
                    }
                } else if (char === delimiter && !inQuotes) {
                    result.push(current);
                    current = '';
                } else {
                    current += char;
                }
            }
            result.push(current);
            return result;
        }

        function parseValue(value) {
            const parseNumbers = document.getElementById('parseNumbers').checked;
            const parseBooleans = document.getElementById('parseBooleans').checked;

            value = value.trim();

            if (value === '') return null;

            if (parseBooleans) {
                if (value.toLowerCase() === 'true') return true;
                if (value.toLowerCase() === 'false') return false;
            }

            if (parseNumbers) {
                if (/^-?\d+$/.test(value)) return parseInt(value, 10);
                if (/^-?\d*\.?\d+$/.test(value)) return parseFloat(value);
            }

            return value;
        }

        function convertToJSON() {
            const csvInput = document.getElementById('csvInput').value.trim();
            if (!csvInput) {
                CodeUtils.Message.error('Please enter CSV data');
                return;
            }

            let delimiter = document.getElementById('delimiter').value;
            if (delimiter === 'auto') {
                delimiter = detectDelimiter(csvInput);
            } else if (delimiter === '\\t') {
                delimiter = '\t';
            }

            const hasHeaders = document.getElementById('hasHeaders').checked;

            const lines = csvInput.split('\n').filter(line => line.trim());
            if (lines.length === 0) {
                CodeUtils.Message.error('No data found');
                return;
            }

            let headers;
            let dataLines;

            if (hasHeaders) {
                headers = parseCSVLine(lines[0], delimiter).map(h => h.trim());
                dataLines = lines.slice(1);
            } else {
                const firstRow = parseCSVLine(lines[0], delimiter);
                headers = firstRow.map((_, i) => `column${i + 1}`);
                dataLines = lines;
            }

            const result = dataLines.map(line => {
                const values = parseCSVLine(line, delimiter);
                const obj = {};
                headers.forEach((header, i) => {
                    obj[header] = parseValue(values[i] || '');
                });
                return obj;
            });

            document.getElementById('jsonOutput').value = JSON.stringify(result, null, 2);
            CodeUtils.Message.success(`Converted ${result.length} rows to JSON!`);
        }

        function copyJSON() {
            const json = document.getElementById('jsonOutput').value;
            if (!json) {
                CodeUtils.Message.error('Nothing to copy');
                return;
            }
            CodeUtils.Clipboard.copy(json);
            CodeUtils.Message.success('Copied to clipboard!');
        }

        function downloadJSON() {
            const json = document.getElementById('jsonOutput').value;
            if (!json) {
                CodeUtils.Message.error('Nothing to download');
                return;
            }
            CodeUtils.FileHandler.download(json, 'data.json', 'application/json');
            CodeUtils.Message.success('JSON file downloaded!');
        }

        function clearAll() {
            document.getElementById('csvInput').value = '';
            document.getElementById('jsonOutput').value = '';
        }
    </script>
</body>
</html>
