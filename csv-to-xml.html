<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- CRITICAL: Apply theme immediately to prevent flash -->
    <script>
        (function() {
            const theme = localStorage.getItem('codeutils-theme');
            if (theme === 'light') {
                document.documentElement.classList.add('light-mode');
            }
        })();
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSV to XML Converter | Convert Spreadsheets - Code Utils</title>
    <meta name="description" content="Convert CSV files to XML format instantly. Customizable element names, download or copy results. 100% private client-side processing. Convert spreadsheets now!">
    <meta name="keywords" content="csv to xml, convert csv xml, csv xml converter, spreadsheet to xml">
    <link rel="canonical" href="https://codeutils.org/csv-to-xml">

    <!-- Favicon and Touch Icons -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <meta name="theme-color" content="#3498db">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://codeutils.org/csv-to-xml">
    <meta property="og:title" content="CSV to XML Converter - Code Utils">
    <meta property="og:description" content="Convert CSV data to XML format with customizable element names. 100% private client-side processing.">
    <meta property="og:image" content="https://codeutils.org/images/og/csv-to-xml.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="CSV to XML Converter - Free online tool">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="CSV to XML Converter - Code Utils">
    <meta name="twitter:description" content="Convert CSV to XML instantly. Free tool with 100% private processing.">
    <meta name="twitter:image" content="https://codeutils.org/images/og/csv-to-xml.png">

    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://www.googletagmanager.com">
    <link rel="dns-prefetch" href="https://www.googletagmanager.com">

        <!-- Google Analytics (only load in production) -->
    <script>
        // Only load Google Analytics if NOT on localhost
        if (window.location.hostname !== 'localhost' && window.location.hostname !== '127.0.0.1') {
            // Load gtag.js
            var script = document.createElement('script');
            script.async = true;
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-RPHPBJ4291';
            document.head.appendChild(script);

            // Initialize GA
            window.dataLayer = window.dataLayer || [];
            function gtag() { dataLayer.push(arguments); }
            gtag('js', new Date());
            gtag('config', 'G-RPHPBJ4291');
        } else {
            // Mock gtag function for localhost (prevents errors)
            window.gtag = function() {
                console.log('GA (localhost - not tracked):', arguments);
            };
        }
    </script>

    <!-- Structured Data: WebApplication Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "CSV to XML Converter - Code Utils",
      "applicationCategory": "DeveloperApplication",
      "operatingSystem": "Any",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "description": "Free CSV to XML converter. Convert CSV spreadsheet data to XML format with customizable element names. 100% client-side processing.",
      "url": "https://codeutils.org/csv-to-xml",
      "browserRequirements": "Requires JavaScript. Requires HTML5.",
      "softwareVersion": "1.0"
    }
    </script>

    <link rel="stylesheet" href="css/common.css">
    <style>
        .options-row {
            display: flex;
            gap: var(--spacing-md);
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: var(--spacing-md);
        }
        .options-row label {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
        }
        .options-row input[type="text"],
        .options-row select {
            padding: var(--spacing-xs) var(--spacing-sm);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            background: var(--bg-secondary);
            color: var(--text-primary);
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="index.html" class="header-logo">
                <h1>Code Utils</h1>
            </a>
            <nav class="header-nav">
                <a href="index.html" class="btn btn-outline btn-sm">All Tools</a>
                <button class="theme-toggle" onclick="CodeUtils.Theme.toggle()">Toggle Dark Mode</button>
            </nav>
        </div>
    </header>

    <div class="container">
        <div class="card" style="margin-bottom: var(--spacing-md); padding: var(--spacing-md);">
            <h2 style="margin-bottom: var(--spacing-xs); color: var(--primary);">CSV to XML Converter</h2>
            <p style="margin: 0; color: var(--text-secondary);">Convert CSV data to XML format.</p>
        </div>

        <div class="editor-section">
            <div class="editor-header">CSV Input</div>
            <textarea id="csvInput" class="editor" placeholder="name,age,city
John,30,NYC
Jane,25,LA"></textarea>
        </div>

        <div class="options-row">
            <label>
                Root element:
                <input type="text" id="rootElement" value="data" placeholder="data">
            </label>
            <label>
                Row element:
                <input type="text" id="rowElement" value="row" placeholder="row">
            </label>
            <label>
                Delimiter:
                <select id="delimiter">
                    <option value=",">Comma</option>
                    <option value=";">Semicolon</option>
                    <option value="\t">Tab</option>
                </select>
            </label>
            <label>
                <input type="checkbox" id="hasHeaders" checked>
                First row is headers
            </label>
        </div>

        <div class="controls">
            <button class="btn" onclick="convertToXML()">Convert to XML</button>
            <button class="btn btn-secondary" onclick="copyXML()">Copy XML</button>
            <button class="btn btn-secondary" onclick="downloadXML()">Download</button>
            <button class="btn btn-outline" onclick="clearAll()">Clear</button>
        </div>

        <div id="message" class="message"></div>

        <div class="editor-section">
            <div class="editor-header">XML Output</div>
            <textarea id="xmlOutput" class="editor" readonly placeholder="XML will appear here..."></textarea>
        </div>

        <!-- Related Tools -->
        <div class="related-tools">
            <h3>Related Tools</h3>
            <div class="related-tools-grid">
                <a href="csv-to-json.html" class="related-tool-card">
                    <span class="related-tool-icon">C>J</span>
                    <span class="related-tool-name">CSV to JSON</span>
                </a>
                <a href="json-to-xml.html" class="related-tool-card">
                    <span class="related-tool-icon">J>X</span>
                    <span class="related-tool-name">JSON to XML</span>
                </a>
                <a href="xml-formatter.html" class="related-tool-card">
                    <span class="related-tool-icon"></></span>
                    <span class="related-tool-name">XML Formatter</span>
                </a>
            </div>
        </div>

        <div class="info-section">
            <h2>About CSV to XML Converter</h2>
            <p>CSV is a common export format for databases, spreadsheets, and reporting tools—but many enterprise systems, data pipelines, and configuration tools require XML. Converting CSV to XML by hand means creating element wrappers for every row and every column value, which is impractical for any dataset larger than a few rows. Our CSV to XML Converter automates this transformation instantly: column headers become element names, and each CSV row becomes a nested XML element. All processing happens in your browser with complete privacy.</p>

            <h3>Key Features</h3>
            <ul>
                <li><strong>Instant Conversion:</strong> Paste CSV and get properly formatted XML output immediately</li>
                <li><strong>Automatic Element Naming:</strong> CSV column headers become XML element names for each row's child elements</li>
                <li><strong>Configurable Root and Row Elements:</strong> Customize the root element name (default: &lt;data&gt;) and row element name (default: &lt;row&gt;)</li>
                <li><strong>Multiple Delimiter Support:</strong> Works with comma, semicolon, tab, and pipe delimiters</li>
                <li><strong>Pretty-Printed Output:</strong> XML output is properly indented for easy reading</li>
                <li><strong>File Upload:</strong> Upload .csv files directly for conversion</li>
                <li><strong>Download as XML:</strong> Save the output as a .xml file with one click</li>
                <li><strong>Privacy First:</strong> 100% client-side processing—your data never leaves your browser</li>
            </ul>

            <h3>How to Use This Tool</h3>

            <p><strong>Method 1: Paste CSV Data</strong></p>
            <ol>
                <li>Paste your CSV data (with headers in the first row) into the input area</li>
                <li>The XML output appears automatically on the right</li>
                <li>Customize root and row element names if needed</li>
                <li>Click "Copy" or "Download XML" to use the result</li>
            </ol>

            <p><strong>Method 2: Upload a CSV File</strong></p>
            <ol>
                <li>Click "Upload" or drag and drop a .csv file</li>
                <li>The file converts automatically</li>
                <li>Download the .xml output file</li>
            </ol>

            <h3>Common Use Cases</h3>

            <p><strong>Preparing Data for XML-Based Import Systems</strong></p>
            <p>Many ERP systems, CRM platforms, and data warehouses accept XML as their bulk import format. When your source data is in CSV (from a database export or spreadsheet), convert it to XML here to prepare the import file. This is particularly useful for one-time data migrations where writing a custom ETL script would take longer than the conversion itself.</p>

            <p><strong>Generating XML for SOAP Services</strong></p>
            <p>When a SOAP API expects multiple records as repeated XML elements, converting a CSV dataset to XML gives you the correctly structured request body. Paste your CSV data, convert to XML, and use the output to construct or test your SOAP request payload.</p>

            <p><strong>Creating Test Data in XML Format</strong></p>
            <p>Testing XML-consuming applications requires XML test data. Generate test records in a spreadsheet (easier to create and edit than XML), export as CSV, and convert to XML here for use in your test suite. This workflow is faster than writing XML test fixtures by hand and makes it easy to add or modify test cases.</p>

            <h3>Tips &amp; Best Practices</h3>
            <ul>
                <li><strong>Ensure column headers are valid XML names:</strong> XML element names cannot contain spaces, start with numbers, or include special characters—use underscores instead of spaces in your CSV headers (first_name instead of "first name")</li>
                <li><strong>Choose meaningful root and row names:</strong> Instead of the defaults (&lt;data&gt; and &lt;row&gt;), use domain-specific names like &lt;employees&gt; and &lt;employee&gt;—this makes the XML self-documenting</li>
                <li><strong>Handle values with special XML characters:</strong> Values containing &lt;, &gt;, &amp;, or quotes are automatically escaped in the output—verify the escaping is correct for your target system</li>
                <li><strong>Validate the output:</strong> Paste the generated XML into an XML validator before using it in production to confirm it is well-formed</li>
            </ul>

            <h3>Frequently Asked Questions</h3>

            <p><strong>Q: What structure does the XML output use?</strong></p>
            <p>A: The output wraps all rows in a root element (default: &lt;data&gt;). Each CSV row becomes a child element (default: &lt;row&gt;). Each cell value becomes a child element of the row, named after the column header. For example, a row with name="John", age="30" produces: &lt;row&gt;&lt;name&gt;John&lt;/name&gt;&lt;age&gt;30&lt;/age&gt;&lt;/row&gt;.</p>

            <p><strong>Q: What if my CSV has no header row?</strong></p>
            <p>A: The first row is used as column names for XML element names. If your CSV has no headers, add a header row first, or the data values will be used as element names—which may not produce valid XML if the values contain spaces or special characters.</p>

            <p><strong>Q: Is my CSV data private?</strong></p>
            <p>A: Yes. All conversion happens in your browser using JavaScript. Your data is never uploaded to any server or stored anywhere.</p>

            <p><strong>Q: Do I need to sign up to use this?</strong></p>
            <p>A: No. The tool is completely free with no registration required.</p>
        </div>
    </div>

    <footer class="footer">
        <p>&copy; 2025 Code Utils. All rights reserved.</p>
        <p>Free developer utilities - 100% client-side processing</p>
    </footer>

    <script src="js/common.js"></script>
    <script>
        CodeUtils.RecentTools.add({
            id: 'csv-to-xml',
            name: 'CSV to XML',
            url: 'csv-to-xml.html'
        });

        CodeUtils.Message.init('message');

        function parseCSVLine(line, delimiter) {
            const result = [];
            let current = '';
            let inQuotes = false;

            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                if (char === '"') {
                    if (inQuotes && line[i + 1] === '"') {
                        current += '"';
                        i++;
                    } else {
                        inQuotes = !inQuotes;
                    }
                } else if (char === delimiter && !inQuotes) {
                    result.push(current.trim());
                    current = '';
                } else {
                    current += char;
                }
            }
            result.push(current.trim());
            return result;
        }

        function escapeXml(str) {
            return String(str)
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;');
        }

        function sanitizeTagName(name) {
            return name.replace(/[^a-zA-Z0-9_]/g, '_').replace(/^(\d)/, '_$1');
        }

        function convertToXML() {
            const csvInput = document.getElementById('csvInput').value.trim();
            if (!csvInput) {
                CodeUtils.Message.error('Please enter CSV data');
                return;
            }

            let delimiter = document.getElementById('delimiter').value;
            if (delimiter === '\\t') delimiter = '\t';
            const rootElement = document.getElementById('rootElement').value || 'data';
            const rowElement = document.getElementById('rowElement').value || 'row';
            const hasHeaders = document.getElementById('hasHeaders').checked;

            const lines = csvInput.split('\n').filter(l => l.trim());
            if (lines.length === 0) {
                CodeUtils.Message.error('No data found');
                return;
            }

            let headers;
            let dataLines;

            if (hasHeaders) {
                headers = parseCSVLine(lines[0], delimiter).map(sanitizeTagName);
                dataLines = lines.slice(1);
            } else {
                const firstRow = parseCSVLine(lines[0], delimiter);
                headers = firstRow.map((_, i) => `field${i + 1}`);
                dataLines = lines;
            }

            let xml = `<?xml version="1.0" encoding="UTF-8"?>\n<${rootElement}>\n`;

            dataLines.forEach(line => {
                const values = parseCSVLine(line, delimiter);
                xml += `  <${rowElement}>\n`;
                headers.forEach((header, i) => {
                    const value = values[i] || '';
                    xml += `    <${header}>${escapeXml(value)}</${header}>\n`;
                });
                xml += `  </${rowElement}>\n`;
            });

            xml += `</${rootElement}>`;

            document.getElementById('xmlOutput').value = xml;
            CodeUtils.Message.success(`Converted ${dataLines.length} rows to XML!`);
        }

        function copyXML() {
            const xml = document.getElementById('xmlOutput').value;
            if (!xml) {
                CodeUtils.Message.error('Nothing to copy');
                return;
            }
            CodeUtils.Clipboard.copy(xml);
            CodeUtils.Message.success('Copied!');
        }

        function downloadXML() {
            const xml = document.getElementById('xmlOutput').value;
            if (!xml) {
                CodeUtils.Message.error('Nothing to download');
                return;
            }
            CodeUtils.FileHandler.download(xml, 'data.xml', 'application/xml');
            CodeUtils.Message.success('Downloaded!');
        }

        function clearAll() {
            document.getElementById('csvInput').value = '';
            document.getElementById('xmlOutput').value = '';
        }
    </script>
</body>
</html>
