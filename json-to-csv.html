<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON to CSV Converter - Code Utils</title>
    <meta name="description" content="Free JSON to CSV converter. Convert JSON arrays to CSV format for spreadsheets. Supports nested objects.">
    <meta name="keywords" content="json to csv, convert json csv, json csv converter, json excel, json spreadsheet">
    <link rel="canonical" href="https://codeutils.org/json-to-csv.html">

    <meta property="og:type" content="website">
    <meta property="og:url" content="https://codeutils.org/json-to-csv.html">
    <meta property="og:title" content="JSON to CSV Converter - Code Utils">
    <meta property="og:description" content="Convert JSON arrays to CSV format for spreadsheets.">

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-RPHPBJ4291"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-RPHPBJ4291');
    </script>

    <link rel="stylesheet" href="css/common.css">
    <style>
        .options-row {
            display: flex;
            gap: var(--spacing-md);
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: var(--spacing-md);
        }
        .options-row label {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
        }
        .options-row select {
            padding: var(--spacing-xs) var(--spacing-sm);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            background: var(--bg-secondary);
            color: var(--text-primary);
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="index.html" class="header-logo">
                <h1>Code Utils</h1>
            </a>
            <nav class="header-nav">
                <a href="index.html" class="btn btn-outline btn-sm">All Tools</a>
                <button class="theme-toggle" onclick="CodeUtils.Theme.toggle()">Toggle Dark Mode</button>
            </nav>
        </div>
    </header>

    <div class="container">
        <div class="card" style="margin-bottom: var(--spacing-md); padding: var(--spacing-md);">
            <h2 style="margin-bottom: var(--spacing-xs); color: var(--primary);">JSON to CSV Converter</h2>
            <p style="margin: 0; color: var(--text-secondary);">Convert JSON arrays to CSV format for spreadsheets.</p>
        </div>

        <div class="editor-section">
            <div class="editor-header">JSON Input (array of objects)</div>
            <textarea id="jsonInput" class="editor" placeholder='[{"name": "John", "age": 30}, {"name": "Jane", "age": 25}]'></textarea>
        </div>

        <div class="options-row">
            <label>
                Delimiter:
                <select id="delimiter">
                    <option value=",">Comma (,)</option>
                    <option value=";">Semicolon (;)</option>
                    <option value="\t">Tab</option>
                    <option value="|">Pipe (|)</option>
                </select>
            </label>
            <label>
                <input type="checkbox" id="includeHeaders" checked>
                Include headers
            </label>
            <label>
                <input type="checkbox" id="flattenNested" checked>
                Flatten nested objects
            </label>
        </div>

        <div class="controls">
            <button class="btn" onclick="convertToCSV()">Convert to CSV</button>
            <button class="btn btn-secondary" onclick="copyCSV()">Copy CSV</button>
            <button class="btn btn-secondary" onclick="downloadCSV()">Download CSV</button>
            <button class="btn btn-outline" onclick="clearAll()">Clear</button>
        </div>

        <div id="message" class="message"></div>

        <div class="editor-section">
            <div class="editor-header">CSV Output</div>
            <textarea id="csvOutput" class="editor" readonly placeholder="CSV output will appear here..."></textarea>
        </div>

        <div class="related-tools">
            <h3>Related Tools</h3>
            <ul class="related-tools-list">
                <li><a href="csv-to-json.html">CSV to JSON</a></li>
                <li><a href="json-formatter.html">JSON Formatter</a></li>
                <li><a href="json-to-yaml.html">JSON to YAML</a></li>
                <li><a href="xml-to-json.html">XML to JSON</a></li>
            </ul>
        </div>

        <div class="info-section">
            <h2>About JSON to CSV Converter</h2>
            <p>This tool converts JSON arrays of objects into CSV (Comma-Separated Values) format.</p>

            <h3>Input Format</h3>
            <p>The input must be a JSON array of objects. Each object becomes a row in the CSV.</p>
            <pre style="background: var(--bg-secondary); padding: var(--spacing-sm); border-radius: var(--radius); overflow-x: auto;">[
  {"name": "John", "age": 30, "city": "NYC"},
  {"name": "Jane", "age": 25, "city": "LA"}
]</pre>

            <h3>Options</h3>
            <ul>
                <li><strong>Delimiter:</strong> Character to separate values (comma, semicolon, tab, pipe)</li>
                <li><strong>Include headers:</strong> Add column names as the first row</li>
                <li><strong>Flatten nested:</strong> Convert nested objects to dot notation (e.g., address.city)</li>
            </ul>
        </div>
    </div>

    <footer class="footer">
        <p>&copy; 2025 Code Utils. All rights reserved.</p>
        <p>Free developer utilities - 100% client-side processing</p>
    </footer>

    <script src="js/common.js"></script>
    <script>
        CodeUtils.RecentTools.add({
            id: 'json-to-csv',
            name: 'JSON to CSV',
            url: 'json-to-csv.html'
        });

        CodeUtils.Message.init('message');

        function flattenObject(obj, prefix = '') {
            const result = {};
            for (const key in obj) {
                const newKey = prefix ? `${prefix}.${key}` : key;
                if (typeof obj[key] === 'object' && obj[key] !== null && !Array.isArray(obj[key])) {
                    Object.assign(result, flattenObject(obj[key], newKey));
                } else if (Array.isArray(obj[key])) {
                    result[newKey] = JSON.stringify(obj[key]);
                } else {
                    result[newKey] = obj[key];
                }
            }
            return result;
        }

        function escapeCSV(value, delimiter) {
            if (value === null || value === undefined) return '';
            const str = String(value);
            if (str.includes(delimiter) || str.includes('"') || str.includes('\n')) {
                return '"' + str.replace(/"/g, '""') + '"';
            }
            return str;
        }

        function convertToCSV() {
            const jsonInput = document.getElementById('jsonInput').value.trim();
            if (!jsonInput) {
                CodeUtils.Message.error('Please enter JSON data');
                return;
            }

            let data;
            try {
                data = JSON.parse(jsonInput);
            } catch (e) {
                CodeUtils.Message.error('Invalid JSON: ' + e.message);
                return;
            }

            if (!Array.isArray(data)) {
                CodeUtils.Message.error('JSON must be an array of objects');
                return;
            }

            if (data.length === 0) {
                CodeUtils.Message.error('JSON array is empty');
                return;
            }

            const delimiter = document.getElementById('delimiter').value === '\\t' ? '\t' : document.getElementById('delimiter').value;
            const includeHeaders = document.getElementById('includeHeaders').checked;
            const flattenNested = document.getElementById('flattenNested').checked;

            // Flatten objects if option is selected
            if (flattenNested) {
                data = data.map(obj => flattenObject(obj));
            }

            // Get all unique keys
            const headers = [...new Set(data.flatMap(obj => Object.keys(obj)))];

            const rows = [];

            if (includeHeaders) {
                rows.push(headers.map(h => escapeCSV(h, delimiter)).join(delimiter));
            }

            for (const obj of data) {
                const row = headers.map(header => escapeCSV(obj[header], delimiter));
                rows.push(row.join(delimiter));
            }

            const csv = rows.join('\n');
            document.getElementById('csvOutput').value = csv;
            CodeUtils.Message.success(`Converted ${data.length} rows to CSV!`);
        }

        function copyCSV() {
            const csv = document.getElementById('csvOutput').value;
            if (!csv) {
                CodeUtils.Message.error('Nothing to copy');
                return;
            }
            CodeUtils.Clipboard.copy(csv);
            CodeUtils.Message.success('Copied to clipboard!');
        }

        function downloadCSV() {
            const csv = document.getElementById('csvOutput').value;
            if (!csv) {
                CodeUtils.Message.error('Nothing to download');
                return;
            }
            CodeUtils.FileHandler.download(csv, 'data.csv', 'text/csv');
            CodeUtils.Message.success('CSV file downloaded!');
        }

        function clearAll() {
            document.getElementById('jsonInput').value = '';
            document.getElementById('csvOutput').value = '';
        }
    </script>
</body>
</html>
