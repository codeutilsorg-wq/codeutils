<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- CRITICAL: Apply theme immediately to prevent flash -->
    <script>
        (function() {
            const theme = localStorage.getItem('codeutils-theme');
            if (theme === 'light') {
                document.documentElement.classList.add('light-mode');
            }
        })();
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON to CSV Converter | Convert JSON to Excel - Code Utils</title>
    <meta name="description" content="Convert JSON arrays to CSV format for Excel and spreadsheets instantly. Supports nested objects, download results. 100% private client-side processing. Convert now!">
    <meta name="keywords" content="json to csv, convert json csv, json csv converter, json excel, json spreadsheet">
    <link rel="canonical" href="https://codeutils.org/json-to-csv">

    <!-- Favicon and Touch Icons -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <meta name="theme-color" content="#3498db">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://codeutils.org/json-to-csv">
    <meta property="og:title" content="JSON to CSV Converter - Code Utils">
    <meta property="og:description" content="Convert JSON arrays to CSV format for Excel and spreadsheets. Supports nested objects. 100% private client-side processing.">
    <meta property="og:image" content="https://codeutils.org/images/og/json-to-csv.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="JSON to CSV Converter - Free online tool">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="JSON to CSV Converter - Code Utils">
    <meta name="twitter:description" content="Convert JSON to CSV instantly. Free tool with 100% private processing.">
    <meta name="twitter:image" content="https://codeutils.org/images/og/json-to-csv.png">

    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://www.googletagmanager.com">
    <link rel="dns-prefetch" href="https://www.googletagmanager.com">

        <!-- Google Analytics (only load in production) -->
    <script>
        // Only load Google Analytics if NOT on localhost
        if (window.location.hostname !== 'localhost' && window.location.hostname !== '127.0.0.1') {
            // Load gtag.js
            var script = document.createElement('script');
            script.async = true;
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-RPHPBJ4291';
            document.head.appendChild(script);

            // Initialize GA
            window.dataLayer = window.dataLayer || [];
            function gtag() { dataLayer.push(arguments); }
            gtag('js', new Date());
            gtag('config', 'G-RPHPBJ4291');
        } else {
            // Mock gtag function for localhost (prevents errors)
            window.gtag = function() {
                console.log('GA (localhost - not tracked):', arguments);
            };
        }
    </script>

    <!-- Structured Data: WebApplication Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "JSON to CSV Converter - Code Utils",
      "applicationCategory": "DeveloperApplication",
      "operatingSystem": "Any",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "description": "Free JSON to CSV converter. Convert JSON arrays to CSV format for Excel and spreadsheets with nested object support. 100% client-side processing.",
      "url": "https://codeutils.org/json-to-csv",
      "browserRequirements": "Requires JavaScript. Requires HTML5.",
      "softwareVersion": "1.0"
    }
    </script>
    <!-- Structured Data: FAQ Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "What JSON structure does this converter accept?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "The converter expects a JSON array of objects—for example [{...}, {...}, {...}]. Each object in the array becomes one row in the CSV. If your JSON is a single object, wrap it in an array first: [{your object}]."
          }
        },
        {
          "@type": "Question",
          "name": "What happens with nested objects and arrays?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "By default, nested objects are serialized as JSON strings in a single cell. Enable the \"Flatten nested\" option to convert nested objects to dot-notation columns (e.g., user.name, user.address.city). Nested arrays are always serialized as JSON strings since CSV does not support array values natively."
          }
        },
        {
          "@type": "Question",
          "name": "Is my JSON data private?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes. All conversion happens in your browser using JavaScript. Your JSON data is never uploaded to any server, stored, or transmitted anywhere."
          }
        },
        {
          "@type": "Question",
          "name": "Do I need to sign up to use this?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "No. The tool is completely free with no registration required."
          }
        }
      ]
    }
    </script>
    <!-- Structured Data: HowTo Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "HowTo",
      "name": "How to Use JSON to CSV Converter | Convert JSON to Excel Online",
      "description": "Step-by-step guide to using the free online JSON to CSV Converter | Convert JSON to Excel tool at codeutils.org",
      "step": [
        {
          "@type": "HowToStep",
          "position": 1,
          "name": "Paste your JSON array of objects into the input area (eac...",
          "text": "Paste your JSON array of objects into the input area (each object becomes one CSV row)"
        },
        {
          "@type": "HowToStep",
          "position": 2,
          "name": "Select your preferred delimiter (comma is standard; use s...",
          "text": "Select your preferred delimiter (comma is standard; use semicolon for European locales)"
        },
        {
          "@type": "HowToStep",
          "position": 3,
          "name": "Choose whether to include a header row and whether to fla...",
          "text": "Choose whether to include a header row and whether to flatten nested objects"
        },
        {
          "@type": "HowToStep",
          "position": 4,
          "name": "Click \"Convert\" to generate the CSV output",
          "text": "Click \"Convert\" to generate the CSV output"
        },
        {
          "@type": "HowToStep",
          "position": 5,
          "name": "Click \"Copy\" or \"Download CSV\" to use the result",
          "text": "Click \"Copy\" or \"Download CSV\" to use the result"
        }
      ]
    }
    </script>

    <link rel="stylesheet" href="css/common.css">
    <style>
        .options-row {
            display: flex;
            gap: var(--spacing-md);
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: var(--spacing-md);
        }
        .options-row label {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
        }
        .options-row select {
            padding: var(--spacing-xs) var(--spacing-sm);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            background: var(--bg-secondary);
            color: var(--text-primary);
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="index.html" class="header-logo">
                <h1>Code Utils</h1>
            </a>
            <nav class="header-nav">
                <a href="index.html" class="btn btn-outline btn-sm">All Tools</a>
                <button class="theme-toggle" onclick="CodeUtils.Theme.toggle()">Toggle Dark Mode</button>
            </nav>
        </div>
    </header>

    <div class="container">
        <div class="card" style="margin-bottom: var(--spacing-md); padding: var(--spacing-md);">
            <h2 style="margin-bottom: var(--spacing-xs); color: var(--primary);">JSON to CSV Converter</h2>
            <p style="margin: 0; color: var(--text-secondary);">Convert JSON arrays to CSV format for spreadsheets.</p>
        </div>

        <div class="editor-section">
            <div class="editor-header">JSON Input (array of objects)</div>
            <textarea id="jsonInput" class="editor" placeholder='[{"name": "John", "age": 30}, {"name": "Jane", "age": 25}]'></textarea>
        </div>

        <div class="options-row">
            <label>
                Delimiter:
                <select id="delimiter">
                    <option value=",">Comma (,)</option>
                    <option value=";">Semicolon (;)</option>
                    <option value="\t">Tab</option>
                    <option value="|">Pipe (|)</option>
                </select>
            </label>
            <label>
                <input type="checkbox" id="includeHeaders" checked>
                Include headers
            </label>
            <label>
                <input type="checkbox" id="flattenNested" checked>
                Flatten nested objects
            </label>
        </div>

        <div class="controls">
            <button class="btn" onclick="convertToCSV()">Convert to CSV</button>
            <button class="btn btn-secondary" onclick="copyCSV()">Copy CSV</button>
            <button class="btn btn-secondary" onclick="downloadCSV()">Download CSV</button>
            <button class="btn btn-outline" onclick="clearAll()">Clear</button>
        </div>

        <div id="message" class="message"></div>

        <div class="editor-section">
            <div class="editor-header">CSV Output</div>
            <textarea id="csvOutput" class="editor" readonly placeholder="CSV output will appear here..."></textarea>
        </div>

        <!-- Related Tools -->
        <div class="related-tools">
            <h3>Related Tools</h3>
            <div class="related-tools-grid">
                <a href="csv-to-json.html" class="related-tool-card">
                    <span class="related-tool-icon">C>J</span>
                    <span class="related-tool-name">CSV to JSON</span>
                </a>
                <a href="json-formatter.html" class="related-tool-card">
                    <span class="related-tool-icon">{ }</span>
                    <span class="related-tool-name">JSON Formatter</span>
                </a>
                <a href="json-to-yaml.html" class="related-tool-card">
                    <span class="related-tool-icon">J>Y</span>
                    <span class="related-tool-name">JSON to YAML</span>
                </a>
                <a href="xml-to-json.html" class="related-tool-card">
                    <span class="related-tool-icon">X>J</span>
                    <span class="related-tool-name">XML to JSON</span>
                </a>
            </div>
        </div>

        <div class="info-section">
            <h2>About JSON to CSV Converter</h2>
            <p>JSON is the standard format for API responses and data interchange, but spreadsheet tools, data analysis pipelines, and database imports typically require CSV. Converting JSON to CSV manually—mapping keys to columns and formatting values correctly—is tedious and error-prone, especially for large datasets. Our JSON to CSV Converter instantly transforms any JSON array of objects into a clean, properly formatted CSV file. Choose your delimiter, control header output, and optionally flatten nested objects—all in your browser with no data sent to any server.</p>

            <h3>Key Features</h3>
            <ul>
                <li><strong>Instant Conversion:</strong> Paste JSON and get CSV output immediately—no button clicks required</li>
                <li><strong>Multiple Delimiters:</strong> Choose comma, semicolon, tab, or pipe as the column separator to match your target system</li>
                <li><strong>Header Row Control:</strong> Include or exclude column headers in the first row of output</li>
                <li><strong>Nested Object Flattening:</strong> Convert nested objects to dot notation (address.city, address.zip) so every value fits in a flat CSV column</li>
                <li><strong>File Upload:</strong> Upload JSON files directly instead of pasting</li>
                <li><strong>Download as CSV:</strong> Save the output as a .csv file with one click</li>
                <li><strong>Privacy First:</strong> 100% client-side processing—your data never leaves your browser</li>
            </ul>

            <h3>How to Use This Tool</h3>

            <p><strong>Method 1: Paste JSON</strong></p>
            <ol>
                <li>Paste your JSON array of objects into the input area (each object becomes one CSV row)</li>
                <li>Select your preferred delimiter (comma is standard; use semicolon for European locales)</li>
                <li>Choose whether to include a header row and whether to flatten nested objects</li>
                <li>Click "Convert" to generate the CSV output</li>
                <li>Click "Copy" or "Download CSV" to use the result</li>
            </ol>

            <p><strong>Method 2: Upload a JSON File</strong></p>
            <ol>
                <li>Click "Upload" or drag and drop a .json file into the upload area</li>
                <li>Configure delimiter and options as needed</li>
                <li>The CSV output generates automatically</li>
                <li>Download the .csv file to your device</li>
            </ol>

            <h3>Common Use Cases</h3>

            <p><strong>Exporting API Data to Spreadsheets</strong></p>
            <p>REST APIs return data as JSON, but business users need data in Excel or Google Sheets. Fetch your API response, paste the JSON array here, and download the CSV to open directly in any spreadsheet application. All keys become column headers automatically, and every object becomes a row—ready for filtering, sorting, and analysis without any manual formatting.</p>

            <p><strong>Preparing Data for Database Import</strong></p>
            <p>Many databases and ETL tools accept CSV as a bulk import format. When your source data is in JSON (from a NoSQL database, a log file, or an API export), convert it to CSV here before importing into MySQL, PostgreSQL, Airtable, or any other system that supports CSV uploads. The flattening option handles nested structures that would otherwise require custom preprocessing code.</p>

            <p><strong>Data Analysis and Reporting</strong></p>
            <p>Data analysis tools like Python pandas, R, and Tableau work naturally with CSV files. Convert your JSON dataset to CSV for easy loading with pd.read_csv() or read.csv()—no custom JSON parsing code required. This is especially useful for one-off analysis tasks where writing a full ETL script would take longer than the analysis itself.</p>

            <h3>Tips &amp; Best Practices</h3>
            <ul>
                <li><strong>Use semicolon delimiter for European Excel:</strong> European versions of Excel use semicolons as the CSV delimiter by default—if your CSV opens incorrectly in Excel, try switching from comma to semicolon</li>
                <li><strong>Enable flatten nested for complex JSON:</strong> If your JSON has nested objects (like address: {city: "NYC", zip: "10001"}), enable flattening to get separate columns (address.city, address.zip) instead of a JSON string in a single cell</li>
                <li><strong>Ensure consistent object keys:</strong> The converter uses the first object's keys as column headers—if different objects have different keys, some values may be missing in the output. Normalize your JSON before converting</li>
                <li><strong>Use tab delimiter for TSV:</strong> Tab-separated files copy cleanly from Excel and work better when field values contain commas—use tab as delimiter when your data includes addresses, descriptions, or other comma-containing text</li>
            </ul>

            <h3>Frequently Asked Questions</h3>

            <p><strong>Q: What JSON structure does this converter accept?</strong></p>
            <p>A: The converter expects a JSON array of objects—for example [{...}, {...}, {...}]. Each object in the array becomes one row in the CSV. If your JSON is a single object, wrap it in an array first: [{your object}].</p>

            <p><strong>Q: What happens with nested objects and arrays?</strong></p>
            <p>A: By default, nested objects are serialized as JSON strings in a single cell. Enable the "Flatten nested" option to convert nested objects to dot-notation columns (e.g., user.name, user.address.city). Nested arrays are always serialized as JSON strings since CSV does not support array values natively.</p>

            <p><strong>Q: Is my JSON data private?</strong></p>
            <p>A: Yes. All conversion happens in your browser using JavaScript. Your JSON data is never uploaded to any server, stored, or transmitted anywhere.</p>

            <p><strong>Q: Do I need to sign up to use this?</strong></p>
            <p>A: No. The tool is completely free with no registration required.</p>
        </div>
    </div>

    <footer class="footer">
        <p>&copy; 2025 Code Utils. All rights reserved.</p>
        <p>Free developer utilities - 100% client-side processing</p>
    </footer>

    <script src="js/common.js"></script>
    <script>
        CodeUtils.RecentTools.add({
            id: 'json-to-csv',
            name: 'JSON to CSV',
            url: 'json-to-csv.html'
        });

        CodeUtils.Message.init('message');

        function flattenObject(obj, prefix = '') {
            const result = {};
            for (const key in obj) {
                const newKey = prefix ? `${prefix}.${key}` : key;
                if (typeof obj[key] === 'object' && obj[key] !== null && !Array.isArray(obj[key])) {
                    Object.assign(result, flattenObject(obj[key], newKey));
                } else if (Array.isArray(obj[key])) {
                    result[newKey] = JSON.stringify(obj[key]);
                } else {
                    result[newKey] = obj[key];
                }
            }
            return result;
        }

        function escapeCSV(value, delimiter) {
            if (value === null || value === undefined) return '';
            const str = String(value);
            if (str.includes(delimiter) || str.includes('"') || str.includes('\n')) {
                return '"' + str.replace(/"/g, '""') + '"';
            }
            return str;
        }

        function convertToCSV() {
            const jsonInput = document.getElementById('jsonInput').value.trim();
            if (!jsonInput) {
                CodeUtils.Message.error('Please enter JSON data');
                return;
            }

            let data;
            try {
                data = JSON.parse(jsonInput);
            } catch (e) {
                CodeUtils.Message.error('Invalid JSON: ' + e.message);
                return;
            }

            if (!Array.isArray(data)) {
                CodeUtils.Message.error('JSON must be an array of objects');
                return;
            }

            if (data.length === 0) {
                CodeUtils.Message.error('JSON array is empty');
                return;
            }

            const delimiter = document.getElementById('delimiter').value === '\\t' ? '\t' : document.getElementById('delimiter').value;
            const includeHeaders = document.getElementById('includeHeaders').checked;
            const flattenNested = document.getElementById('flattenNested').checked;

            // Flatten objects if option is selected
            if (flattenNested) {
                data = data.map(obj => flattenObject(obj));
            }

            // Get all unique keys
            const headers = [...new Set(data.flatMap(obj => Object.keys(obj)))];

            const rows = [];

            if (includeHeaders) {
                rows.push(headers.map(h => escapeCSV(h, delimiter)).join(delimiter));
            }

            for (const obj of data) {
                const row = headers.map(header => escapeCSV(obj[header], delimiter));
                rows.push(row.join(delimiter));
            }

            const csv = rows.join('\n');
            document.getElementById('csvOutput').value = csv;
            CodeUtils.Message.success(`Converted ${data.length} rows to CSV!`);
        }

        function copyCSV() {
            const csv = document.getElementById('csvOutput').value;
            if (!csv) {
                CodeUtils.Message.error('Nothing to copy');
                return;
            }
            CodeUtils.Clipboard.copy(csv);
            CodeUtils.Message.success('Copied to clipboard!');
        }

        function downloadCSV() {
            const csv = document.getElementById('csvOutput').value;
            if (!csv) {
                CodeUtils.Message.error('Nothing to download');
                return;
            }
            CodeUtils.FileHandler.download(csv, 'data.csv', 'text/csv');
            CodeUtils.Message.success('CSV file downloaded!');
        }

        function clearAll() {
            document.getElementById('jsonInput').value = '';
            document.getElementById('csvOutput').value = '';
        }
    </script>
</body>
</html>
